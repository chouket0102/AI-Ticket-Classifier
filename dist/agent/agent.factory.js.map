{"version":3,"sources":["../../src/agent/agent.factory.ts"],"sourcesContent":["import { AzureChatOpenAI } from '@langchain/openai';\r\nimport { ChatOpenAI } from '@langchain/openai';\r\nimport * as dotenv from 'dotenv';\r\nimport { ModelProvider } from './enum/model-provider.enum';\r\nimport { ReactAgentBuilder } from './agent.builder';\r\nimport { CompiledStateGraph, MessagesAnnotation } from '@langchain/langgraph';\r\nimport { PostgresSaver } from '@langchain/langgraph-checkpoint-postgres';\r\nimport { ChatGoogleGenerativeAI } from '@langchain/google-genai';\r\n\r\ndotenv.config();\r\n\r\nexport class AgentFactory {\r\n  public static createAgent(\r\n    modelProvider: ModelProvider,\r\n    tools: any[],\r\n    checkpointer?: PostgresSaver,\r\n  ): CompiledStateGraph<typeof MessagesAnnotation, any> {\r\n    if (!modelProvider) {\r\n      throw new Error('Model provider is required');\r\n    }\r\n\r\n    switch (modelProvider) {\r\n      case ModelProvider.OPENAI: {\r\n        return new ReactAgentBuilder(\r\n          tools,\r\n          new ChatOpenAI({\r\n            model: process.env.OPENAI_MODEL,\r\n          }),\r\n        ).build(checkpointer);\r\n      }\r\n      case ModelProvider.GOOGLE: {\r\n        return new ReactAgentBuilder(\r\n          tools,\r\n          new ChatGoogleGenerativeAI({\r\n            model: process.env.GOOGLE_GENAI_MODEL || '',\r\n          }),\r\n        ).build(checkpointer);\r\n      }\r\n      case ModelProvider.AZURE_OPENAI: {\r\n        return new ReactAgentBuilder(\r\n          tools,\r\n          new AzureChatOpenAI({\r\n            azureOpenAIApiKey: process.env.AZURE_OPENAI_API_KEY,\r\n            azureOpenAIApiInstanceName: AgentFactory.extractInstanceName(\r\n              process.env.AZURE_OPENAI_ENDPOINT || '',\r\n            ),\r\n            azureOpenAIApiDeploymentName:\r\n              process.env.AZURE_OPENAI_DEPLOYMENT_NAME || 'gpt-4o',\r\n            azureOpenAIApiVersion:\r\n              process.env.AZURE_OPENAI_API_VERSION || '2024-08-01-preview',\r\n            temperature: 0.1,\r\n            maxTokens: 4000,\r\n          }),\r\n        ).build(checkpointer);\r\n      }\r\n    }\r\n  }\r\n\r\n  private static extractInstanceName(endpoint: string): string {\r\n    const match = endpoint.match(\r\n      /https:\\/\\/([^.]+)\\.openai\\.azure\\.com/,\r\n    );\r\n    return match ? match[1] : endpoint;\r\n  }\r\n}\r\n"],"names":["AgentFactory","dotenv","config","createAgent","modelProvider","tools","checkpointer","Error","ModelProvider","OPENAI","ReactAgentBuilder","ChatOpenAI","model","process","env","OPENAI_MODEL","build","GOOGLE","ChatGoogleGenerativeAI","GOOGLE_GENAI_MODEL","AZURE_OPENAI","AzureChatOpenAI","azureOpenAIApiKey","AZURE_OPENAI_API_KEY","azureOpenAIApiInstanceName","extractInstanceName","AZURE_OPENAI_ENDPOINT","azureOpenAIApiDeploymentName","AZURE_OPENAI_DEPLOYMENT_NAME","azureOpenAIApiVersion","AZURE_OPENAI_API_VERSION","temperature","maxTokens","endpoint","match"],"mappings":";;;;+BAWaA;;;eAAAA;;;wBAXmB;gEAER;mCACM;8BACI;6BAGK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEvCC,QAAOC,MAAM;AAEN,IAAA,AAAMF,eAAN,MAAMA;IACX,OAAcG,YACZC,aAA4B,EAC5BC,KAAY,EACZC,YAA4B,EACwB;QACpD,IAAI,CAACF,eAAe;YAClB,MAAM,IAAIG,MAAM;QAClB;QAEA,OAAQH;YACN,KAAKI,gCAAa,CAACC,MAAM;gBAAE;oBACzB,OAAO,IAAIC,+BAAiB,CAC1BL,OACA,IAAIM,kBAAU,CAAC;wBACbC,OAAOC,QAAQC,GAAG,CAACC,YAAY;oBACjC,IACAC,KAAK,CAACV;gBACV;YACA,KAAKE,gCAAa,CAACS,MAAM;gBAAE;oBACzB,OAAO,IAAIP,+BAAiB,CAC1BL,OACA,IAAIa,mCAAsB,CAAC;wBACzBN,OAAOC,QAAQC,GAAG,CAACK,kBAAkB,IAAI;oBAC3C,IACAH,KAAK,CAACV;gBACV;YACA,KAAKE,gCAAa,CAACY,YAAY;gBAAE;oBAC/B,OAAO,IAAIV,+BAAiB,CAC1BL,OACA,IAAIgB,uBAAe,CAAC;wBAClBC,mBAAmBT,QAAQC,GAAG,CAACS,oBAAoB;wBACnDC,4BAA4BxB,aAAayB,mBAAmB,CAC1DZ,QAAQC,GAAG,CAACY,qBAAqB,IAAI;wBAEvCC,8BACEd,QAAQC,GAAG,CAACc,4BAA4B,IAAI;wBAC9CC,uBACEhB,QAAQC,GAAG,CAACgB,wBAAwB,IAAI;wBAC1CC,aAAa;wBACbC,WAAW;oBACb,IACAhB,KAAK,CAACV;gBACV;QACF;IACF;IAEA,OAAemB,oBAAoBQ,QAAgB,EAAU;QAC3D,MAAMC,QAAQD,SAASC,KAAK,CAC1B;QAEF,OAAOA,QAAQA,KAAK,CAAC,EAAE,GAAGD;IAC5B;AACF"}