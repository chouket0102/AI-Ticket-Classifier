{"version":3,"sources":["../../../../src/api/agent/controller/agent.controller.ts"],"sourcesContent":["import { Body, Controller, Get, Param, Post, Query, Sse } from '@nestjs/common';\r\nimport { Observable } from 'rxjs';\r\nimport { ApiOperation, ApiResponse, ApiTags } from '@nestjs/swagger';\r\nimport { AgentService } from '../service/agent/agent.service';\r\nimport { SseMessage } from '../dto/sse.dto';\r\nimport { MessageDto, SseMessageDto } from '../dto/message.dto';\r\nimport { MessageResponseDto } from '../dto/message.response.dto';\r\nimport { TicketDto } from '../dto/ticket.dto';\r\nimport { TicketAnalysisResponseDto } from '../dto/ticket-response.dto';\r\n\r\n@ApiTags('Agent')\r\n@Controller('agent')\r\nexport class AgentController {\r\n  constructor(private agentService: AgentService) {}\r\n\r\n  @Post('analyze')\r\n  @ApiOperation({ summary: 'Analyze a support ticket using the adaptive agent' })\r\n  @ApiResponse({\r\n    status: 200,\r\n    description: 'Returns structured ticket analysis with classification, metadata, and recommendations',\r\n    type: TicketAnalysisResponseDto,\r\n  })\r\n  async analyzeTicket(\r\n    @Body() ticketDto: TicketDto,\r\n  ): Promise<TicketAnalysisResponseDto> {\r\n    return await this.agentService.analyzeTicket(ticketDto);\r\n  }\r\n\r\n  @Post('chat')\r\n  @ApiOperation({ summary: 'Chat with the agent' })\r\n  async chat(@Body() messageDto: MessageDto): Promise<MessageResponseDto> {\r\n    return await this.agentService.chat(messageDto);\r\n  }\r\n\r\n  @Sse('stream')\r\n  @ApiOperation({ summary: 'Stream agent responses' })\r\n  @ApiResponse({\r\n    status: 200,\r\n    description: 'Returns a stream of agent responses',\r\n    type: SseMessage,\r\n  })\r\n  async stream(\r\n    @Query() messageDto: SseMessageDto,\r\n  ): Promise<Observable<SseMessage>> {\r\n    return await this.agentService.stream(messageDto);\r\n  }\r\n\r\n  @Get('history/:threadId')\r\n  @ApiOperation({ summary: 'Get chat history' })\r\n  @ApiResponse({\r\n    status: 200,\r\n    description: 'Returns the chat history',\r\n    type: [MessageResponseDto],\r\n  })\r\n  async getHistory(\r\n    @Param('threadId') threadId: string,\r\n  ): Promise<MessageResponseDto[]> {\r\n    return await this.agentService.getHistory(threadId);\r\n  }\r\n}\r\n"],"names":["AgentController","analyzeTicket","ticketDto","agentService","chat","messageDto","stream","getHistory","threadId","summary","status","description","type","TicketAnalysisResponseDto","SseMessage","MessageResponseDto"],"mappings":";;;;+BAYaA;;;eAAAA;;;wBAZkD;yBAEZ;8BACtB;wBACF;4BACe;oCACP;2BACT;mCACgB;;;;;;;;;;;;;;;AAInC,IAAA,AAAMA,kBAAN,MAAMA;IAGX,MAOMC,cACJ,AAAQC,SAAoB,EACQ;QACpC,OAAO,MAAM,IAAI,CAACC,YAAY,CAACF,aAAa,CAACC;IAC/C;IAEA,MAEME,KAAK,AAAQC,UAAsB,EAA+B;QACtE,OAAO,MAAM,IAAI,CAACF,YAAY,CAACC,IAAI,CAACC;IACtC;IAEA,MAOMC,OACJ,AAASD,UAAyB,EACD;QACjC,OAAO,MAAM,IAAI,CAACF,YAAY,CAACG,MAAM,CAACD;IACxC;IAEA,MAOME,WACJ,AAAmBC,QAAgB,EACJ;QAC/B,OAAO,MAAM,IAAI,CAACL,YAAY,CAACI,UAAU,CAACC;IAC5C;IA7CA,YAAY,AAAQL,YAA0B,CAAE;aAA5BA,eAAAA;IAA6B;AA8CnD;;;;QA3CkBM,SAAS;;;QAEvBC,QAAQ;QACRC,aAAa;QACbC,MAAMC,4CAAyB;;;;;;;;;;;;QASjBJ,SAAS;;;;;;;;;;;;QAMTA,SAAS;;;QAEvBC,QAAQ;QACRC,aAAa;QACbC,MAAME,kBAAU;;;;;;;;;;;;QASFL,SAAS;;;QAEvBC,QAAQ;QACRC,aAAa;QACbC,MAAM;YAACG,sCAAkB;SAAC"}